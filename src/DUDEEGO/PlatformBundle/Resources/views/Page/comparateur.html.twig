{% extends "DUDEEGOPlatformBundle::layout.html.twig" %}

{% block title %}
  Comparateur - {{ parent() }}
{% endblock %}

{% block dudeegoplatform_body %}

  <div class="row">
    <div class="col-sm-2 col-md-2 col-lg-2 col-xl-2">
      <div class="well">
        <form action="{{ path('dudeego_platform_filterComparateur') }}" method="POST">

          {# Les erreurs générales du formulaire. #}
          {% if form_errors(form) %}
            <div class="alert alert-danger" role="alert">
              {{ form_errors(form) }}
            </div>
          {% endif %}

          <div class="form-group" id="">

            {{ form_label(form.nomuniversite, 'Rechercher') }}
            {{ form_widget(form.nomuniversite) }}

            {{ form_label(form.formations) }}
            {{ form_widget(form.formations) }}

            {{ form_label(form.langues) }}
            {{ form_widget(form.langues) }}

            {{ form_label(form.villes) }}
            {{ form_widget(form.villes) }}

            {{ form_label(form.pays) }}
            {{ form_widget(form.pays) }}

          </div>
          <div>

           {{ form_widget(form.rechercher, {'attr': {'class': 'btn btn-primary'}}) }}
           {{ form_widget(form.reinitialiser, {'attr': {'class': 'btn btn-danger'}}) }}
         </div>

         {{ form_rest(form) }}
       </form>
     </div>

   </div>

   <div class="col-sm-8 col-md-8 col-lg-8 col-xl-8">

    <table id="universite" class="table table-striped table-bordered nowrap" cellspacing="0" width="100%" data-order='[[ 1, "asc" ]]' data-page-length='25'>
      <thead>
        <tr>
          <th>Etablissement</th>
          <th>Description</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% if listUniversite is defined %}
          {% for rowUniversite in listUniversite %}
            <tr>
              <td>
                <div style="float:left;">
                  {% for itemimage in rowUniversite.images %}
                    <img class="media-object img-rounded img-responsive"  src="{{ itemimage.url }}" alt="{{ itemimage.alt }}">
                  {% endfor %}
                </div>
                <div style="float:right;">
                  <a href="{{ path('dudeego_platform_detailsComparateur', { 'id' : rowUniversite.id } ) }}" >{{ rowUniversite.nometablissement }}</a>
                </div>  
              </td>
              <td>
                {{ rowUniversite.description|slice(0, 50) ~ '...' }}
              </td>
              <td>
                <!-- Button trigger modal -->
                <div style="float:left;">
                  <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">Inscription</button>
                </div>
                <div style="float:right;">
                 <!-- trigger favorite -->
                 <a href="{{ path('dudeego_platform_favorisComparateur', {'id': rowUniversite.id }) }}">Favoris</a>
              </div>                
            </td>
          </tr>
        {% endfor %}
      {% endif %}
    </tbody>
  </table>
</div>
<div class="col-sm-2 col-md-2 col-lg-2 col-xl-2">
  <div class="well">
    <table id="favoris" class="table table-striped table-bordered nowrap" cellspacing="0" width="100%" data-order='[[ 1, "asc" ]]' data-page-length='25'>
      <thead>
        <tr>
          <th>Etablissement</th>
        </tr>
      </thead>
      <tbody>
        {% if lisFavoristUniversite is defined %}
          {% for rowUniversite in lisFavoristUniversite %}
            <tr>
              <td>
                {% for itemimage in rowUniversite.images %}
                  <img class="media-object img-rounded img-responsive"  src="{{ itemimage.url }}" alt="{{ itemimage.alt }}">
                {% endfor %}
              </td>
            </tr>
          {% endfor %}
        {% endif %}
      </tbody>
    </table>
    <button type="button" class="btn btn-primary">Comparer</button>
  </div>
</div>
</div>

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Inscription à une université</h4>
      </div>
      <div class="modal-body" >
        <p>
          Si vous souhaitez vous inscrire à une universite, vous devez avoir un compte utilisateur sur notre plateforme. Pour la création d'un compte, suivez le guide <a href="{{ path('fos_user_registration_register') }}">ici</a>.
        </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Fermer</button>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  $('#universite').DataTable( {
    paging: true,
    responsive: true,
  } );
</script>

<script type="text/javascript">
  $('#favoris').DataTable( {
    paging: false,
    responsive: true
  } );
</script>

{% endblock %}
